import streamlit as st # ì›¹ ì•±ì„ ë§Œë“¤ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬
import pandas as pd    # ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬
import numpy as np     # ìˆ«ì ê³„ì‚°ì„ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬
import FinanceDataReader as fdr # ì£¼ê°€ ë°ì´í„°ë¥¼ ì‰½ê²Œ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬
import datetime        # ë‚ ì§œì™€ ì‹œê°„ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬
import warnings        # ê²½ê³  ë©”ì‹œì§€ë¥¼ ì œì–´í•˜ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬

# ë¶ˆí•„ìš”í•œ ê²½ê³  ë©”ì‹œì§€ë¥¼ ìˆ¨ê¹ë‹ˆë‹¤.
warnings.filterwarnings('ignore')

# --- 1. ì£¼ê°€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ (ETFì— ë§ì¶° ì¬ì‚¬ìš©) ---
@st.cache_data(ttl=3600*24) # 24ì‹œê°„ ë™ì•ˆ ìºì‹±
def get_etf_data(ticker, start_date, end_date):
    """
    FinanceDataReaderë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ETFì˜ ì£¼ê°€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
    Args:
        ticker (str): ETF ì¢…ëª© ì½”ë“œ (ì˜ˆ: '305720' KODEX 2ì°¨ì „ì§€ì‚°ì—…)
        start_date (datetime.date): ë°ì´í„° ì‹œì‘ì¼
        end_date (datetime.date): ë°ì´í„° ì¢…ë£Œì¼
    Returns:
        pd.DataFrame: ETF ì£¼ê°€ ë°ì´í„° (ë‚ ì§œ, ì‹œê°€, ê³ ê°€, ì €ê°€, ì¢…ê°€, ê±°ë˜ëŸ‰ ë“±)
    """
    try:
        df = fdr.DataReader(ticker, start=start_date, end=end_date)
        return df
    except Exception as e:
        # ì˜¤ë¥˜ ë©”ì‹œì§€ ëŒ€ì‹  ê²½ê³ ë§Œ ì¶œë ¥í•˜ê³  ë¹ˆ ë°ì´í„°í”„ë ˆì„ ë°˜í™˜
        st.warning(f"ğŸš¨ ETF '{ticker}' ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {e}. í•´ë‹¹ ETFëŠ” ìƒì¥ì¼ ì´í›„ ë°ì´í„°ë¶€í„° í‘œì‹œë©ë‹ˆë‹¤.")
        return pd.DataFrame() 

# --- Streamlit ì›¹ ì•±ì˜ ë©”ì¸ ë ˆì´ì•„ì›ƒ êµ¬ì„± ì‹œì‘ ---
st.set_page_config(layout="wide", page_title="ETF ê¸°ë°˜ ì„¹í„° ë¡œí…Œì´ì…˜ ë¶„ì„") # í˜ì´ì§€ ì œëª© ì„¤ì •
st.title("ğŸ“ˆ ETF ê¸°ë°˜ ì‚°ì—…/ì„¹í„° ë¡œí…Œì´ì…˜ ì „ëµ ë¶„ì„")

st.markdown("""
í•´ë‹¹ í˜ì´ì§€ëŠ” **ETF(ìƒì¥ì§€ìˆ˜í€ë“œ) ë°ì´í„°ë¥¼ í™œìš©**í•˜ì—¬ ì£¼ìš” ì‚°ì—…/ì„¹í„°ì˜ ê³¼ê±° ì„±ê³¼ë¥¼ ë¹„êµí•˜ê³ , 
ì¥ê¸°ì ì¸ ê´€ì ì—ì„œ ì–´ë–¤ ì„¹í„°ê°€ ê°•ì„¸ë¥¼ ë³´ì˜€ëŠ”ì§€ ë¶„ì„í•©ë‹ˆë‹¤.
**ì„ íƒëœ ê¸°ê°„ ë‚´ ìƒì¥ëœ ETFëŠ” ìƒì¥ì¼ ì´í›„ë¶€í„° ë°ì´í„°ê°€ í‘œì‹œë©ë‹ˆë‹¤.**
""")

# --- ë¶„ì„í•  ì‚°ì—…/ì„¹í„°ë³„ ETF ì •ì˜ ---
# ì‹¤ì œ ì‹œì¥ì—ì„œ ìœ ë™ì„±ì´ ë†’ê³  ëŒ€í‘œì„±ì„ ë ëŠ” ETF í‹°ì»¤ë¥¼ ì„ ì •í–ˆìŠµë‹ˆë‹¤.
# (2025ë…„ 6ì›” í˜„ì¬ ê¸°ì¤€ ì˜ˆì‹œ, ì‹¤ì œ íˆ¬ì ì‹œ ìµœì‹  ì •ë³´ í™•ì¸ í•„ìˆ˜)#TIGER Fnë°˜ë„ì²´TOP10396500
sector_etfs = {
    "ë°˜ë„ì²´": {"í‹°ì»¤": "396500", "ì´ë¦„": "TIGER Fnë°˜ë„ì²´"}, # 2019-09-09 ìƒì¥
    "2ì°¨ì „ì§€": {"í‹°ì»¤": "305720", "ì´ë¦„": "KODEX 2ì°¨ì „ì§€ì‚°ì—…"}, # 2018-09-11 ìƒì¥
    "ìë™ì°¨": {"í‹°ì»¤": "102110", "ì´ë¦„": "KODEX ìë™ì°¨"}, # 2008-04-22 ìƒì¥
    "ë°”ì´ì˜¤": {"í‹°ì»¤": "244790", "ì´ë¦„": "KODEX ë°”ì´ì˜¤"}, # 2016-09-06 ìƒì¥
    "ì¸í„°ë„·": {"í‹°ì»¤": "369370", "ì´ë¦„": "TIGER KRXì¸í„°ë„·Kë‰´ë”œ"}, # 2020-08-07 ìƒì¥
    "ì€í–‰": {"í‹°ì»¤": "117700", "ì´ë¦„": "KODEX ì€í–‰"}, # 2008-11-25 ìƒì¥
    "ì² ê°•": {"í‹°ì»¤": "139240", "ì´ë¦„": "TIGER ì² ê°•"}, # 2011-08-25 ìƒì¥
    "ìŒì‹ë£Œ": {"í‹°ì»¤": "139250", "ì´ë¦„": "TIGER ìŒì‹ë£Œ"}, # 2011-08-25 ìƒì¥
    "ê²Œì„": {"í‹°ì»¤": "364980", "ì´ë¦„": "KODEX ê²Œì„ì‚°ì—…"}, # 2020-08-07 ìƒì¥
    "ê±´ì„¤": {"í‹°ì»¤": "139260", "ì´ë¦„": "TIGER ê±´ì„¤"} # 2011-08-25 ìƒì¥
}

st.subheader("ğŸ“Š ë¶„ì„ ì„¤ì •")

# --- ì‚¬ìš©ì ì…ë ¥: ë¶„ì„í•  ì„¹í„°ì™€ ê¸°ê°„ ì„ íƒ ---
# ëª¨ë“  ì„¹í„°ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì„ íƒí•˜ë„ë¡ ë³€ê²½
all_sector_names = list(sector_etfs.keys())
selected_sectors = st.multiselect(
    "ğŸ“Š **ë¶„ì„í•  ì‚°ì—…/ì„¹í„°ë¥¼ ì„ íƒí•˜ì„¸ìš” (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥):**",
    options=all_sector_names,
    default=all_sector_names # ëª¨ë“  ì„¹í„°ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì„ íƒ
)

# ì§€ë‚œ 10ë…„ê°„ì˜ ì‹œì‘ì¼ë¡œ ê¸°ë³¸ ì„¤ì • (ì˜¤ëŠ˜ ë‚ ì§œ - 10ë…„)
today = datetime.date.today()
# Current time is Monday, June 16, 2025 at 3:05:32 PM KST.
# 2025ë…„ 6ì›” 16ì¼ ê¸°ì¤€ 10ë…„ ì „ì€ 2015ë…„ 6ì›” 16ì¼ (ëŒ€ëµì ì¸ ê³„ì‚°)
start_of_10_years_ago = today - datetime.timedelta(days=365 * 10 + 2) 


col1, col2 = st.columns(2)
with col1:
    start_date_sector = st.date_input("ë¶„ì„ ì‹œì‘ì¼", value=start_of_10_years_ago, key='sector_start_date')
with col2:
    end_date_sector = st.date_input("ë¶„ì„ ì¢…ë£Œì¼", value=today, key='sector_end_date')


# ì„¹í„° ì„±ê³¼ ë¶„ì„ ì‹œì‘ ë²„íŠ¼
if st.button("ì„¹í„° ì„±ê³¼ ë¶„ì„ ì‹œì‘", key='analyze_sectors_button'):
    if not selected_sectors:
        st.warning("ë¶„ì„í•  ì‚°ì—…/ì„¹í„°ë¥¼ í•˜ë‚˜ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.")
    else:
        st.subheader("ğŸ“ˆ ì„ íƒëœ ETF ì„¹í„°ë³„ ëˆ„ì  ìˆ˜ìµë¥  ë¹„êµ")
        
        # ëª¨ë“  ETFì˜ ìˆ˜ìµë¥ ì„ ë‹´ì„ ë¹ˆ DataFrameì„ ìƒì„± (ë‚ ì§œ ì¸ë±ìŠ¤ ë¯¸ë¦¬ ìƒì„±)
        # ì„ íƒëœ ê¸°ê°„ ë‚´ ëª¨ë“  ë‚ ì§œë¥¼ í¬í•¨í•˜ëŠ” DatetimeIndexë¥¼ ë§Œë“­ë‹ˆë‹¤.
        full_date_range = pd.date_range(start=start_date_sector, end=end_date_sector, freq='B') # 'B'ëŠ” ì˜ì—…ì¼ ê¸°ì¤€
        all_etf_cumulative_returns = pd.DataFrame(index=full_date_range)
        
        # ì‹¤ì œë¡œ ë°ì´í„°ê°€ ë¡œë“œëœ ì„¹í„°ë“¤ì˜ ì´ë¦„ì„ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸
        loaded_sectors = []
        
        # ì§„í–‰ ìƒí™©ì„ ë³´ì—¬ì£¼ëŠ” ë°” (ë°ì´í„° ë¡œë”©ì´ ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.)
        progress_text = "ETF ë°ì´í„° ë¡œë”© ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”..."
        my_bar = st.progress(0, text=progress_text)
        
        # ì„ íƒëœ ê° ì„¹í„°ì— ëŒ€í•´ ë°˜ë³µí•˜ë©° ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆ˜ìµë¥ ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
        for i, sector_name in enumerate(selected_sectors):
            # ì§„í–‰ë°” ì—…ë°ì´íŠ¸
            my_bar.progress((i + 1) / len(selected_sectors), text=f"'{sector_name}' ETF ë°ì´í„° ë¡œë”© ì¤‘...")
            
            etf_ticker = sector_etfs[sector_name]["í‹°ì»¤"]
            etf_name = sector_etfs[sector_name]["ì´ë¦„"]

            # ETF ì£¼ê°€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
            etf_data = get_etf_data(etf_ticker, start_date_sector, end_date_sector)
            
            if not etf_data.empty: # ETF ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆë‹¤ë©´
                # ì¢…ê°€ ê¸°ì¤€ìœ¼ë¡œ ì¼ë³„ ëˆ„ì  ìˆ˜ìµë¥ ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
                # ì²« ë‚ ì˜ ì¢…ê°€ë¥¼ 1ë¡œ ê¸°ì¤€í•˜ì—¬ ì´í›„ ë‚ ì§œì˜ ìˆ˜ìµë¥ ì„ ìƒëŒ€ì ìœ¼ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤.
                etf_cumulative_return = etf_data['Close'] / etf_data['Close'].iloc[0]
                
                # ì „ì²´ ë‚ ì§œ ë²”ìœ„ ë°ì´í„°í”„ë ˆì„ì— í•´ë‹¹ ETFì˜ ëˆ„ì  ìˆ˜ìµë¥ ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
                # join()ì„ ì‚¬ìš©í•˜ì—¬ ë‚ ì§œ ì¸ë±ìŠ¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë¥¼ í•©ì¹©ë‹ˆë‹¤.
                all_etf_cumulative_returns = all_etf_cumulative_returns.join(etf_cumulative_return.rename(sector_name))
                loaded_sectors.append(sector_name) # ì„±ê³µì ìœ¼ë¡œ ë¡œë“œëœ ì„¹í„°ë§Œ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
            else:
                # ë°ì´í„°ê°€ ì—†ëŠ” ETFëŠ” ê²½ê³  ë©”ì‹œì§€ë§Œ ì¶œë ¥í•˜ê³  ë¶„ì„ì€ ê³„ì† ì§„í–‰í•©ë‹ˆë‹¤.
                pass 

        my_bar.empty() # ëª¨ë“  ë¡œë”©ì´ ëë‚˜ë©´ ì§„í–‰ë°”ë¥¼ ìˆ¨ê¹ë‹ˆë‹¤.

        # ëª¨ë“  ETF ë°ì´í„°ê°€ í•©ì³ì§„ í›„ì— NaN ê°’ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.
        # ìƒì¥ì¼ ì´ì „ì˜ NaN ê°’ì€ 1.0ìœ¼ë¡œ ì±„ì›Œ ì°¨íŠ¸ ì‹œì‘ì ì„ í†µì¼í•˜ê³ ,
        # ì´í›„ì˜ NaN ê°’(ì˜ˆ: íŠ¹ì •ì¼ íœ´ì¥ ë“±)ì€ ì´ì „ ìœ íš¨í•œ ê°’ìœ¼ë¡œ ì±„ì›ë‹ˆë‹¤.
        returns_df = all_etf_cumulative_returns.fillna(1.0).ffill().bfill()
        
        # --- ì´ì „ ìˆ˜ì • ë¶€ë¶„ (KeyError í•´ê²°) ---
        if loaded_sectors: # ë¡œë“œëœ ì„¹í„°ê°€ í•˜ë‚˜ë¼ë„ ìˆë‹¤ë©´
            returns_df = returns_df[loaded_sectors]
        else: # ë¡œë“œëœ ì„¹í„°ê°€ í•˜ë‚˜ë„ ì—†ë‹¤ë©´
            st.error("ì„ íƒëœ ê¸°ê°„ ë‚´ ìœ íš¨í•œ ETF ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ê°„ ë˜ëŠ” ì„¹í„° ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.")
            st.stop() # ë” ì´ìƒ ì§„í–‰í•˜ì§€ ì•Šê³  ì•±ì„ ì¤‘ë‹¨í•©ë‹ˆë‹¤.
        # --- ì´ì „ ìˆ˜ì • ë¶€ë¶„ ë ---


        if not returns_df.empty and not returns_df.columns.empty: # ìµœì¢… ë°ì´í„°í”„ë ˆì„ì´ ë¹„ì–´ìˆì§€ ì•Šê³  ì»¬ëŸ¼ì´ ìˆë‹¤ë©´
            st.write("ì„ íƒëœ ETF ì„¹í„°ë³„ ëˆ„ì  ìˆ˜ìµë¥  ì¶”ì´ (ì´ˆê¸°ê°’ 1.0 ê¸°ì¤€):")
            st.dataframe(returns_df.tail()) # ìµœê·¼ ë°ì´í„° 5ê°œ ë³´ì—¬ì£¼ê¸°

            st.line_chart(returns_df) # ëˆ„ì  ìˆ˜ìµë¥  ì°¨íŠ¸ ê·¸ë¦¬ê¸°

            st.markdown("""
            **ì°¨íŠ¸ í•´ì„:**
            ìœ„ ì°¨íŠ¸ëŠ” ì„ íƒëœ ê¸°ê°„ ë™ì•ˆ ê° ì‚°ì—…/ì„¹í„° ETFì˜ íˆ¬ì ì‹œì‘ ì‹œì (1.0) ëŒ€ë¹„ ëˆ„ì ëœ ìˆ˜ìµë¥  ë³€í™”ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
            * **ê³¡ì„ ì´ ìœ„ë¡œ ê°€íŒŒë¥´ê²Œ ìƒìŠ¹í• ìˆ˜ë¡** í•´ë‹¹ ê¸°ê°„ ë™ì•ˆ ë†’ì€ ìˆ˜ìµë¥ ì„ ê¸°ë¡í–ˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
            * ì—¬ëŸ¬ ê³¡ì„ ì„ ë¹„êµí•˜ì—¬ ì–´ë–¤ ì„¹í„°ê°€ íŠ¹ì • ì‹œì ì— ê°•ì„¸ë¥¼ ë³´ì˜€ëŠ”ì§€ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            * **ì°¨íŠ¸ ì‹œì‘ ì§€ì ì—ì„œ 1.0ìœ¼ë¡œ í‰í‰í•˜ê²Œ ìœ ì§€ë˜ë‹¤ê°€ ìƒìŠ¹í•˜ëŠ” ê³¡ì„ **ì€ í•´ë‹¹ ETFê°€ ë¶„ì„ ì‹œì‘ì¼ ì´í›„ì— ìƒì¥ë˜ì—ˆìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
            * ê¸°ê°„ ì¤‘ **ìƒëŒ€ì ìœ¼ë¡œ ë†’ì€ ìœ„ì¹˜ì— ìˆëŠ” ì„¹í„°**ê°€ í•´ë‹¹ ì‹œê¸° ì‹œì¥ì„ ì£¼ë„í•œ ì„¹í„°ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.
            """)

            # ê¸°ê°„ë³„ ìµœì¢… ìˆ˜ìµë¥  ìš”ì•½ ë° ë§‰ëŒ€ ì°¨íŠ¸
            # Charting-specific data (pure numeric for bar chart)
            final_returns_for_chart = returns_df.iloc[-1] - 1 
            final_returns_for_chart_percent = (final_returns_for_chart * 100).dropna().sort_values(ascending=False) 
            
            # --- ìƒˆë¡œìš´ ì‹œë„: Seriesì˜ ì´ë¦„ì„ ëª…ì‹œí•˜ê³ , ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì „ë‹¬ ---
            # Altairê°€ Seriesë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì´ ê¹Œë‹¤ë¡œìš¸ ìˆ˜ ìˆìœ¼ë¯€ë¡œ,
            # ëª…í™•í•œ ì»¬ëŸ¼ëª…ì„ ê°€ì§„ DataFrame í˜•íƒœë¡œ ë³€í™˜í•˜ì—¬ ì „ë‹¬í•©ë‹ˆë‹¤.
            if not final_returns_for_chart_percent.empty:
                # Seriesë¥¼ DataFrameìœ¼ë¡œ ë³€í™˜. ì¸ë±ìŠ¤ëŠ” ì„¹í„° ì´ë¦„, ê°’ì€ ìˆ˜ìµë¥ 
                chart_data = pd.DataFrame({
                    'Sector': final_returns_for_chart_percent.index.astype(str), # ì¸ë±ìŠ¤ë¥¼ ë¬¸ìì—´ë¡œ ëª…ì‹œì  ë³€í™˜
                    'Return_Percent': final_returns_for_chart_percent.values.astype(float) # ê°’ì„ ì‹¤ìˆ˜í˜•ìœ¼ë¡œ ëª…ì‹œì  ë³€í™˜
                })
                
                # Streamlitì˜ bar_chartëŠ” Altairë¥¼ ë˜í•‘í•œ ê²ƒì´ë¯€ë¡œ,
                # Altair ì°¨íŠ¸ë¥¼ ì§ì ‘ êµ¬ì„±í•˜ì—¬ ë°ì´í„° íƒ€ì…ê³¼ ì¸ì½”ë”©ì„ ëª…ì‹œí•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                # ì´ë¥¼ ìœ„í•´ altair ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ import í•©ë‹ˆë‹¤.
                import altair as alt # ì—¬ê¸°ì— ì¶”ê°€ (ì½”ë“œ ìƒë‹¨ì— import altair as alt ì¶”ê°€ í•„ìš”)

                chart = alt.Chart(chart_data).mark_bar().encode(
                    x=alt.X('Sector:N', sort='-y', title='ì„¹í„°'), # N: Nominal (ëª…ëª©í˜•)
                    y=alt.Y('Return_Percent:Q', title='ìˆ˜ìµë¥  (%)') # Q: Quantitative (ì •ëŸ‰í˜•)
                ).properties(
                    title='ë¶„ì„ ê¸°ê°„ ë™ì•ˆ ìµœì¢… ìˆ˜ìµë¥ '
                )
                st.altair_chart(chart, use_container_width=True) # Altair ì°¨íŠ¸ ë Œë”ë§
                
            else:
                st.warning("ì„ íƒëœ ê¸°ê°„ ë‚´ ìœ íš¨í•œ ETF ìˆ˜ìµë¥  ë°ì´í„°ê°€ ì—†ì–´ ìµœì¢… ìˆ˜ìµë¥ ì„ ê³„ì‚°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            # --- ìˆ˜ì • ë ---

            # Display data (formatted string for dataframe)
            st.write("ğŸ“ˆ **ë¶„ì„ ê¸°ê°„ ë™ì•ˆ ìµœì¢… ìˆ˜ìµë¥  (%):** (ë°ì´í„°í”„ë ˆì„ í‘œ)")
            st.dataframe(final_returns_for_chart_percent.apply(lambda x: f"{x:.2f}%")) # % í˜•ì‹ìœ¼ë¡œ í‘œì‹œ


        #     # --- ETF ëª©ë¡ í™•ì¸ ê¸°ëŠ¥ ---
        #     st.markdown("---")
        #     st.subheader("ğŸ” ì‚¬ìš© ê°€ëŠ¥í•œ í•œêµ­ ETF ëª©ë¡ í™•ì¸ (FinanceDataReader)")
        #     st.info("FinanceDataReaderê°€ ì œê³µí•˜ëŠ” ëª¨ë“  í•œêµ­ ETF ëª©ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. "
        #             "ì´ë¥¼ ì°¸ê³ í•˜ì—¬ 'ë¶„ì„í•  ì‚°ì—…/ì„¹í„°ë¥¼ ì„ íƒí•˜ì„¸ìš”' ë¶€ë¶„ì˜ ETFë¥¼ ì§ì ‘ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
            
        #     if st.button("í•œêµ­ ETF ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°", key='load_etf_list'):
        #         try:
        #             etf_list_df = fdr.StockListing('ETF/KR')
        #             st.dataframe(etf_list_df[['Symbol', 'Name', 'Sector', 'ListingDate']].head(200)) # ìƒìœ„ 200ê°œë§Œ
        #             st.download_button(
        #                 label="ì „ì²´ ETF ëª©ë¡ CSV ë‹¤ìš´ë¡œë“œ",
        #                 data=etf_list_df.to_csv(index=False).encode('utf-8'),
        #                 file_name="korean_etf_list.csv",
        #                 mime="text/csv",
        #             )
        #             st.markdown("---")
        #             st.write("`Symbol` ì»¬ëŸ¼ì˜ ê°’ì„ ë³µì‚¬í•˜ì—¬ ìœ„ì— ì •ì˜ëœ `sector_etfs` ë”•ì…”ë„ˆë¦¬ì— ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
        #             st.write("ì˜ˆì‹œ: `\"ìƒˆë¡œìš´ì„¹í„°\": {\"í‹°ì»¤\": \"ìƒˆë¡œìš´í‹°ì»¤\", \"ì´ë¦„\": \"ìƒˆë¡œìš´ETFì´ë¦„\"}`")

        #         except Exception as e:
        #             st.error(f"ğŸš¨ í•œêµ­ ETF ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")
        # else:
        #     st.error("ì„ íƒëœ ì„¹í„°ì— ëŒ€í•œ ìœ íš¨í•œ ETF ë°ì´í„°ê°€ ì—†ì–´ ë¶„ì„ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì„¹í„° ì •ì˜ì™€ ê¸°ê°„ ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.")

st.markdown("---")
st.caption("ë©´ì±… ì¡°í•­: ì´ ë„êµ¬ëŠ” ì •ë³´ ì œê³µ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©ë˜ë©° íˆ¬ì ì¡°ì–¸ì„ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê³¼ê±°ì˜ ì„±ê³¼ëŠ” ë¯¸ë˜ì˜ ê²°ê³¼ë¥¼ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ETFì˜ ìƒì¥ì¼ì´ ì„ íƒëœ ë¶„ì„ ì‹œì‘ì¼ë³´ë‹¤ ëŠ¦ì„ ê²½ìš° í•´ë‹¹ ETFëŠ” ë¶„ì„ ê¸°ê°„ ë™ì•ˆì˜ ì „ì²´ ë°ì´í„°ë¥¼ í¬í•¨í•˜ì§€ ëª»í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
